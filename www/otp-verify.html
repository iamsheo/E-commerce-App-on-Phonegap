<!DOCTYPE html>
<html lang="en">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0"/>
  <title>Cartway App</title>

  
	<link href="css/materialize.min.css" type="text/css" rel="stylesheet" media="screen,projection"/>
	<script src="js/jquery-3.2.1.min.js"></script>
	<script src="js/materialize.min.js"></script>
	<link rel="stylesheet" href="css/style.css">
	<link rel="stylesheet" href="icons/css/font-awesome.min.css">

</head>
<body>

 <nav>
    <div class="nav-wrapper">
      <a href="#" class="brand-logo center">Cartway</a>
     
    </div>
</nav>




	<div class="row card">
	<br>
	
	<div class="col s8 offset-s2" style="border: 1px dashed #eee;padding:15px;margin-bottom:40px;">
	<img src="images/logo.png" style="width:100%;"></img>
	<p style="font-weight:600;text-align:center;">Please Verify Your Number </p>
	<hr style="border: 1px solid #eee;">
	
		<form action="select-location.html">
			<div class="input-field col s12">
			  <input id="otp" type="text" class="validate">
			  <label for="otp">Enter OTP</label>
			</div>
			
			 <button class="btn waves-effect waves-light" type="button" id="submit">Submit
				
			  </button>
		</form>
		<br>
		<div id="info" style="color:red;"></div>
		<br>
		<div id="localstorage" style="color:red;"></div>
		
		
	</div>
	
	<br><br><br>
	<img src="images/bg.png" class="responsive-img " >
	</div>
	 
	  
	  
	  
		<script>
		$(document).ready(function(){
		
		$name="";;
		$mobile="";;
		
				
									// Check browser support
									if (typeof(Storage) !== "undefined") {
										
										$name=localStorage.getItem("name");
										$mobile=localStorage.getItem("mobile");
										$profile_status=localStorage.getItem("profile_status");
										
										
										// Retrieve
									/*	$("#localstorage").html(
										
											localStorage.getItem("response")+" | "+
											localStorage.getItem("name")+" | "+
											localStorage.getItem("mobile")+" | "+
											localStorage.getItem("otp")
										);
									*/
										
									} else {
										$("#localstorage").html("Sorry, your browser does not support Web Storage...");
									}
				  
				  
		
			
				$("#submit").click(function(){
				
					$otp=$("#otp").val();
					
					
					
					if($otp.length!=4)
						{
							$("#info").html("Please fill the details");
						}
						else
						{
						
								$.ajax({
									type: 'GET',
									url: 'http://cartway.in/app-work/web-api/public/verify-otp',
									data: {
										otp: $otp , 
										mobile: $mobile,
										status:$profile_status,
									},
									dataType: 'jsonp',
									crossDomain: true,
									
							}).done(function(response){
									console.log(response);
									
									$.each( response, function( key, val ) {
												//alert( key+ val.response  );
												
												$status=val.response;
												$str="Error"
												
												if($status == $str){
													$("#info").html("Please Enter Valid OTP");
												}else{
												
													localStorage.setItem("user_status", "mobile_number_verified");
													$("#info").html("Verified");
													
													//window.location.replace("select-location.html");
												
												}
											});
									
									
									
							}).fail(function(error){
									alert("error");
							});
					
					
					}
				
				});
					
				  
				  
				  
				  
						
		});
		</script>
	  
	  
<script type="text/javascript" src="cordova.js"></script>
<script type="text/javascript">
        app.initialize();
</script>
	  
</body>
</html>